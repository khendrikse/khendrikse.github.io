<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="Online space, blog and portfolio"/><title>Karin Hendrikse | TIL: How to set security headers for Gatsby Develop</title><script type="application/ld+json">{&quot;@context&quot;:&quot;https://schema.org/&quot;,&quot;@type&quot;:&quot;BreadcrumbList&quot;,&quot;itemListElement&quot;:[{&quot;@type&quot;:&quot;ListItem&quot;,&quot;position&quot;:1,&quot;name&quot;:&quot;home&quot;,&quot;item&quot;:&quot;https://khendrikse.github.io/&quot;},{&quot;@type&quot;:&quot;ListItem&quot;,&quot;position&quot;:2,&quot;name&quot;:&quot;blog&quot;,&quot;item&quot;:&quot;https://khendrikse.github.io/blog/&quot;},{&quot;@type&quot;:&quot;ListItem&quot;,&quot;position&quot;:3,&quot;name&quot;:&quot;TIL: How to set security headers for Gatsby Develop&quot;,&quot;item&quot;:&quot;https://khendrikse.github.io/post/2021-09-25-set-your-gatsby-develop-security-headers&quot;}]}</script><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/712c88f00d05ee40.css" as="style"/><link rel="stylesheet" href="/_next/static/css/712c88f00d05ee40.css" data-n-g=""/><link rel="preload" href="/_next/static/css/03191e7d313ab930.css" as="style"/><link rel="stylesheet" href="/_next/static/css/03191e7d313ab930.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-6f22bfb6ab07d707.js" defer=""></script><script src="/_next/static/chunks/framework-5d917c6d60c28f7c.js" defer=""></script><script src="/_next/static/chunks/main-c5f572bf693152d0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ff8e7e8c05220191.js" defer=""></script><script src="/_next/static/chunks/103-fac3e5a613e6c36e.js" defer=""></script><script src="/_next/static/chunks/682-ba7ed80520a90eba.js" defer=""></script><script src="/_next/static/chunks/600-b88dde15b40655ac.js" defer=""></script><script src="/_next/static/chunks/175-9a4c26ac43d5d542.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bpostname%5D-9d3bdbb99b6f8bae.js" defer=""></script><script src="/_next/static/4OWx1Aktir_tYSFI5ybN_/_buildManifest.js" defer=""></script><script src="/_next/static/4OWx1Aktir_tYSFI5ybN_/_ssgManifest.js" defer=""></script><script src="/_next/static/4OWx1Aktir_tYSFI5ybN_/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="wrapper"><section class="layout"><header><nav class="navbar_navbar__lC1dX"><div class="navbar_navbar__inner__u9kLF"><h1 class="navbar_navbar__title__oKE_L"><a href="/">Karin Hendrikse</a></h1><ul class="navbar_navbar__menu__XlTKp"><li><a class="navbar_navbar__menu__item__6e5_F" href="/about">About</a></li><li><a class="navbar_navbar__menu__item__6e5_F" href="/blog">Blog</a></li><li><a class="navbar_navbar__menu__item__6e5_F" href="/projects">Projects</a></li><li><a class="navbar_navbar__menu__item__6e5_F" href="/">Home</a></li><li><a class="navbar_navbar__menu__icon__cKwHu" aria-label="RSS feed" href="https://khendrikse.github.io/feeds/feed.xml"><svg width="14px" height="14px" alt="RSS" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.503 20.752A3.25 3.25 0 0 1 3.252 24 3.25 3.25 0 0 1 0 20.752a3.25 3.25 0 0 1 3.252-3.248 3.25 3.25 0 0 1 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242 0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24C23.97 10.769 13.245.046 0 0v4.812z"></path></svg></a></li></ul></div></nav></header><div class="content"><article><img class="post_post__header__image__F9dvV" src="data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAHAAoDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAUG/8QAHBAAAgICAwAAAAAAAAAAAAAAAAECAxESUYGS/8QAFAEBAAAAAAAAAAAAAAAAAAAAA//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/ANjZNqDeueyzvZzHyAOJ/9k=" alt="a white cat napping" style="transition:0.2s filter linear;filter:blur(20px)"/><div class="container"><div class="post_post__header__title__nmuW6"><div class="breadcrumbs_breadcrumbs__K4VlV"><span><a href="/">Home</a></span><span><a href="/blog">blog</a></span><span>TIL: How to set security headers for Gatsby Develop</span></div><h2>TIL: How to set security headers for Gatsby Develop</h2><div class="post_post__date_label__jb050">2021-09-25</div></div></div><div class="post_post__body__Iz5iR"><div class="container"><div class="post_post__intro__JzsWI"></div><p>Photo by <a href="https://unsplash.com/@hngstrm">Henry &amp; Co</a> on <a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>
<p>There might come a time that you want to run your <a href="https://www.gatsbyjs.com/">Gatsby</a> app with security headers in development. To do this, you can utilize advanced proxying. Gatsby has a way to expose the <a href="https://expressjs.com/">Express.js</a> development server it uses to run the app whenever you use <code>gatsby develop</code>. This way you can add Express middleware.</p>
<h2>TL;DR</h2>
<p>If you just want to get your solution, feel free to use this setup inside your <code>gatsby-config.js</code> to set any security header you want. This example shows how you could set the <code>X-Frame-Options</code> HTTP response header to DENY.</p>
<pre><pre style="text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;color:#c3cee3;background:#263238;font-family:Roboto Mono, monospace;font-size:1em;line-height:1.5em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;overflow:auto;position:relative;margin:0.5em 0;padding:1.25em 1em"><code class="language-js" style="text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;color:#c3cee3;background:#263238;font-family:Roboto Mono, monospace;font-size:1em;line-height:1.5em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#546e7a">// gatsby-config.js</span><span>
</span>
<span></span><span class="token token" style="color:#c792ea;font-style:italic">const</span><span> </span><span class="token token" style="color:#89ddff">{</span><span> createProxyMiddleware </span><span class="token token" style="color:#89ddff">}</span><span> </span><span class="token token" style="color:#89ddff">=</span><span> </span><span class="token token" style="color:#c792ea">require</span><span class="token token" style="color:#89ddff">(</span><span class="token token" style="color:#c3e88d">&quot;http-proxy-middleware&quot;</span><span class="token token" style="color:#89ddff">)</span><span>
</span>
<span>module</span><span class="token token" style="color:#89ddff">.</span><span class="token token property-access">exports</span><span> </span><span class="token token" style="color:#89ddff">=</span><span> </span><span class="token token" style="color:#89ddff">{</span><span>
</span><span>  </span><span class="token token function-variable" style="color:#c792ea">developMiddleware</span><span class="token token" style="color:#89ddff">:</span><span> </span><span class="token token parameter">app</span><span> </span><span class="token token arrow" style="color:#89ddff">=&gt;</span><span> </span><span class="token token" style="color:#89ddff">{</span><span>
</span><span>     app</span><span class="token token" style="color:#89ddff">.</span><span class="token token method property-access" style="color:#c792ea">use</span><span class="token token" style="color:#89ddff">(</span><span class="token token" style="color:#89ddff">(</span><span class="token token parameter">req</span><span class="token token parameter" style="color:#89ddff">,</span><span class="token token parameter"> res</span><span class="token token parameter" style="color:#89ddff">,</span><span class="token token parameter"> next</span><span class="token token" style="color:#89ddff">)</span><span> </span><span class="token token arrow" style="color:#89ddff">=&gt;</span><span> </span><span class="token token" style="color:#89ddff">{</span><span>
</span><span>      res</span><span class="token token" style="color:#89ddff">.</span><span class="token token method property-access" style="color:#c792ea">set</span><span class="token token" style="color:#89ddff">(</span><span class="token token" style="color:#c3e88d">&#x27;X-Frame-Options&#x27;</span><span class="token token" style="color:#89ddff">,</span><span> </span><span class="token token" style="color:#c3e88d">&#x27;DENY&#x27;</span><span class="token token" style="color:#89ddff">)</span><span class="token token" style="color:#89ddff">;</span><span>
</span><span>      </span><span class="token token" style="color:#c792ea">next</span><span class="token token" style="color:#89ddff">(</span><span class="token token" style="color:#89ddff">)</span><span class="token token" style="color:#89ddff">;</span><span>
</span><span>    </span><span class="token token" style="color:#89ddff">}</span><span class="token token" style="color:#89ddff">)</span><span class="token token" style="color:#89ddff">;</span><span>
</span><span>  </span><span class="token token" style="color:#89ddff">}</span><span class="token token" style="color:#89ddff">,</span><span>
</span><span></span><span class="token token" style="color:#89ddff">}</span></code></pre></pre>
<h2>Let&#x27;s break it down</h2>
<p>First we make sure we actually have a <code>gatsby-config.js</code> file. This file should be in the root of your Gatsby project and it can contain a bunch of different information. If you want to know more about this file, check out <a href="https://www.gatsbyjs.com/docs/reference/config-files/gatsby-config/">Gatsby&#x27;s own docs</a>.</p>
<pre><pre style="text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;color:#c3cee3;background:#263238;font-family:Roboto Mono, monospace;font-size:1em;line-height:1.5em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;overflow:auto;position:relative;margin:0.5em 0;padding:1.25em 1em"><code class="language-js" style="text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;color:#c3cee3;background:#263238;font-family:Roboto Mono, monospace;font-size:1em;line-height:1.5em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#546e7a">// gatsby-config.js</span><span>
</span>
<span>module</span><span class="token token" style="color:#89ddff">.</span><span class="token token property-access">exports</span><span> </span><span class="token token" style="color:#89ddff">=</span><span> </span><span class="token token" style="color:#89ddff">{</span><span>
</span><span>  </span><span class="token token" style="color:#546e7a">// an empty config file!</span><span>
</span><span></span><span class="token token" style="color:#89ddff">}</span></code></pre></pre>
<h3>Using developMiddleware</h3>
<p>To expose Express.js we use the configuration key called <code>developMiddleware</code>. We pass it a function that takes a parameter called <code>app</code>. We can use that to <a href="https://expressjs.com/en/guide/using-middleware.html">add middleware</a> to Express.js.</p>
<p>We use <code>app.use()</code> and pass it a function that takes <code>req, res, next</code> parameters. Inside the function we set our security header on the <code>res</code> (response) object. After this, we call the next function that we got as a parameter.</p>
<pre><pre style="text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;color:#c3cee3;background:#263238;font-family:Roboto Mono, monospace;font-size:1em;line-height:1.5em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;overflow:auto;position:relative;margin:0.5em 0;padding:1.25em 1em"><code class="language-js" style="text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;color:#c3cee3;background:#263238;font-family:Roboto Mono, monospace;font-size:1em;line-height:1.5em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#546e7a">// gatsby-config.js</span><span>
</span>
<span>module</span><span class="token token" style="color:#89ddff">.</span><span class="token token property-access">exports</span><span> </span><span class="token token" style="color:#89ddff">=</span><span> </span><span class="token token" style="color:#89ddff">{</span><span>
</span><span>  </span><span class="token token function-variable" style="color:#c792ea">developMiddleware</span><span class="token token" style="color:#89ddff">:</span><span> </span><span class="token token parameter">app</span><span> </span><span class="token token arrow" style="color:#89ddff">=&gt;</span><span> </span><span class="token token" style="color:#89ddff">{</span><span>
</span><span>     app</span><span class="token token" style="color:#89ddff">.</span><span class="token token method property-access" style="color:#c792ea">use</span><span class="token token" style="color:#89ddff">(</span><span class="token token" style="color:#89ddff">(</span><span class="token token parameter">req</span><span class="token token parameter" style="color:#89ddff">,</span><span class="token token parameter"> res</span><span class="token token parameter" style="color:#89ddff">,</span><span class="token token parameter"> next</span><span class="token token" style="color:#89ddff">)</span><span> </span><span class="token token arrow" style="color:#89ddff">=&gt;</span><span> </span><span class="token token" style="color:#89ddff">{</span><span>
</span><span>      res</span><span class="token token" style="color:#89ddff">.</span><span class="token token method property-access" style="color:#c792ea">set</span><span class="token token" style="color:#89ddff">(</span><span class="token token" style="color:#c3e88d">&#x27;X-Frame-Options&#x27;</span><span class="token token" style="color:#89ddff">,</span><span> </span><span class="token token" style="color:#c3e88d">&#x27;DENY&#x27;</span><span class="token token" style="color:#89ddff">)</span><span class="token token" style="color:#89ddff">;</span><span>
</span><span>      </span><span class="token token" style="color:#c792ea">next</span><span class="token token" style="color:#89ddff">(</span><span class="token token" style="color:#89ddff">)</span><span class="token token" style="color:#89ddff">;</span><span>
</span><span>    </span><span class="token token" style="color:#89ddff">}</span><span class="token token" style="color:#89ddff">)</span><span class="token token" style="color:#89ddff">;</span><span>
</span><span>  </span><span class="token token" style="color:#89ddff">}</span><span class="token token" style="color:#89ddff">,</span><span>
</span><span></span><span class="token token" style="color:#89ddff">}</span></code></pre></pre>
<p>Done! You should now be able to run <code>gatsby develop</code> and see the proper security headers on the documents that it serves you. Make sure to restart your server if you already had it running though, otherwise the changes won&#x27;t come through.</p></div></div></article></div></section></div><div class="footer_footer__7PBRV"><div class="footer_footer__links__Z7tzO"><a class="footer_footer__link__VHWPt" aria-label="DEV.to" href="https://dev.to/khenhey"><svg width="24px" height="24px" alt="DEV.to" viewBox="0 32 448 448" xmlns="http://www.w3.org/2000/svg"><path d="M120.12 208.29c-3.88-2.9-7.77-4.35-11.65-4.35H91.03v104.47h17.45c3.88 0 7.77-1.45 11.65-4.35s5.82-7.25 5.82-13.06v-69.65c-.01-5.8-1.96-10.16-5.83-13.06zM404.1 32H43.9C19.7 32 .06 51.59 0 75.8v360.4C.06 460.41 19.7 480 43.9 480h360.2c24.21 0 43.84-19.59 43.9-43.8V75.8c-.06-24.21-19.7-43.8-43.9-43.8zM154.2 291.19c0 18.81-11.61 47.31-48.36 47.25h-46.4V172.98h47.38c35.44 0 47.36 28.46 47.37 47.28zm100.68-88.66H201.6v38.42h32.57v29.57H201.6v38.41h53.29v29.57h-62.18c-11.16.29-20.44-8.53-20.72-19.69V193.7c-.27-11.15 8.56-20.41 19.71-20.69h63.19zm103.64 115.29c-13.2 30.75-36.85 24.63-47.44 0l-38.53-144.8h32.57l29.71 113.72 29.57-113.72h32.58z"></path></svg></a><a class="footer_footer__link__VHWPt" aria-label="GitHub" href="https://github.com/khendrikse"><svg width="24px" height="24px" alt="GitHub" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid"><path d="M64 1.564c11.611 0 22.32 2.86 32.125 8.583 9.806 5.722 17.57 13.486 23.292 23.292C125.139 43.244 128 53.953 128 65.564c0 13.944-4.07 26.486-12.208 37.625-8.14 11.139-18.653 18.847-31.542 23.125-1.5.278-2.611.083-3.333-.583a3.237 3.237 0 0 1-1.077-2.273l-.006-.374.064-10.196.017-5.517.002-1.724c0-5.389-1.445-9.333-4.334-11.833 3.167-.334 6.014-.834 8.542-1.5 2.528-.667 5.139-1.75 7.833-3.25 2.695-1.5 4.945-3.348 6.75-5.542 1.806-2.194 3.278-5.111 4.417-8.75 1.139-3.639 1.708-7.82 1.708-12.542 0-6.61-2.194-12.333-6.583-17.166 2.055-5.056 1.833-10.723-.667-17-1.555-.5-3.805-.195-6.75.916-2.944 1.112-5.5 2.334-7.666 3.667l-3.167 2c-5.167-1.444-10.5-2.167-16-2.167s-10.833.723-16 2.167a40.185 40.185 0 0 0-.514-.347l-.571-.375-.308-.197-.658-.416-1.096-.676-.395-.239c-.22-.133-.46-.27-.72-.412l-.543-.289-.594-.299a41.772 41.772 0 0 0-.645-.31l-.696-.32c-.12-.055-.242-.11-.367-.165l-.772-.337-.823-.348-.873-.359-.925-.37c-3.167-1.25-5.528-1.624-7.083-1.124-2.5 6.277-2.722 11.944-.667 17-4.389 4.833-6.583 10.555-6.583 17.166 0 4.723.57 8.89 1.708 12.5 1.139 3.611 2.597 6.528 4.375 8.75 1.778 2.223 4.014 4.084 6.708 5.584 2.695 1.5 5.306 2.583 7.834 3.25 2.527.666 5.375 1.166 8.541 1.5-2.166 2-3.528 4.86-4.083 8.583a16.527 16.527 0 0 1-3.75 1.25c-1.333.278-2.917.417-4.75.417-1.833 0-3.653-.597-5.458-1.792-1.806-1.194-3.348-2.93-4.625-5.208-1.056-1.778-2.403-3.222-4.042-4.334-1.639-1.11-3.014-1.777-4.125-2l-1.667-.25c-1.166 0-1.972.126-2.416.375-.445.25-.584.57-.417.959.167.389.417.778.75 1.166.333.39.695.723 1.083 1l.584.417c1.222.556 2.43 1.611 3.625 3.167 1.194 1.555 2.07 2.972 2.625 4.25l.833 1.916c.722 2.111 1.945 3.82 3.667 5.125 1.722 1.306 3.583 2.14 5.583 2.5 2 .362 3.93.556 5.792.584 1.706.025 3.143-.054 4.313-.239l2.228-.386.01 3.427.074 8.49c0 1-.361 1.833-1.084 2.5-.722.666-1.833.86-3.333.583-12.889-4.278-23.403-11.986-31.542-23.125C4.07 92.049 0 79.509 0 65.564c0-11.612 2.861-22.32 8.583-32.125 5.723-9.806 13.486-17.57 23.292-23.292 9.592-5.598 20.049-8.458 31.37-8.58L64 1.565ZM24.25 93.48c.166-.39-.028-.723-.584-1-.555-.167-.916-.111-1.083.166-.167.39.028.723.583 1 .5.334.862.278 1.084-.166Zm2.583 2.833c.389-.278.333-.722-.167-1.333-.555-.5-1-.584-1.333-.25-.389.277-.333.722.167 1.333.555.555 1 .639 1.333.25Zm2.5 3.75c.5-.389.5-.917 0-1.583-.444-.723-.916-.89-1.416-.5-.5.277-.5.777 0 1.5.5.722.972.916 1.416.583Zm3.5 3.5c.417-.417.345-.907-.215-1.47l-.118-.113c-.667-.667-1.222-.75-1.667-.25-.5.444-.389.972.333 1.583.667.667 1.223.75 1.667.25Zm4.75 2.083c.167-.61-.194-1.055-1.083-1.333-.834-.222-1.361-.028-1.584.583-.222.611.14 1.028 1.084 1.25.781.313 1.294.186 1.538-.38l.045-.12Zm5.25.417c0-.722-.472-1.028-1.417-.917-.888 0-1.333.306-1.333.917 0 .722.472 1.028 1.417.917.83 0 1.272-.267 1.327-.799l.006-.118Zm4.833-.833c-.11-.612-.61-.862-1.5-.75-.888.166-1.277.583-1.166 1.25.11.666.61.888 1.5.666.83-.207 1.224-.56 1.182-1.058l-.016-.108Z" fill="currentColor"></path></svg></a><a class="footer_footer__link__VHWPt" aria-label="linkedin" href="https://www.linkedin.com/in/karinhendrikse/"><svg width="24px" height="24px" alt="LinkedIn" xmlns="http://www.w3.org/2000/svg"><path d="M19 0H5a5 5 0 0 0-5 5v14a5 5 0 0 0 5 5h14a5 5 0 0 0 5-5V5a5 5 0 0 0-5-5zM8 19H5V8h3v11zM6.5 6.732c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zM20 19h-3v-5.604c0-3.368-4-3.113-4 0V19h-3V8h3v1.765c1.396-2.586 7-2.777 7 2.476V19z"></path></svg></a><a class="footer_footer__link__VHWPt" aria-label="RSS feed" href="https://khendrikse.github.io/feeds/feed.xml"><svg width="24px" height="24px" alt="RSS" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.503 20.752A3.25 3.25 0 0 1 3.252 24 3.25 3.25 0 0 1 0 20.752a3.25 3.25 0 0 1 3.252-3.248 3.25 3.25 0 0 1 3.251 3.248zM0 8.18v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817C15.777 15.29 8.721 8.242 0 8.18zm0-3.368C10.58 4.858 19.152 13.406 19.183 24H24C23.97 10.769 13.245.046 0 0v4.812z"></path></svg></a>© <!-- -->2022<!-- --> Karin Hendrikse</div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"siteTitle":"Karin Hendrikse","frontmatter":{"layout":"post","title":"TIL: How to set security headers for Gatsby Develop","published":false,"description":"If, for any reason, you need to run gatsby develop and set security headers. Using advanced proxying is the way to go.","intro":null,"cover_image":"2021-09-25.jpg","cover_image_alt":"a white cat napping"},"markdownBody":"\nPhoto by [Henry \u0026 Co](https://unsplash.com/@hngstrm) on [Unsplash](https://unsplash.com/?utm_source=unsplash\u0026utm_medium=referral\u0026utm_content=creditCopyText)\n\nThere might come a time that you want to run your [Gatsby](https://www.gatsbyjs.com/) app with security headers in development. To do this, you can utilize advanced proxying. Gatsby has a way to expose the [Express.js](https://expressjs.com/) development server it uses to run the app whenever you use `gatsby develop`. This way you can add Express middleware.\n\n## TL;DR\n\nIf you just want to get your solution, feel free to use this setup inside your `gatsby-config.js` to set any security header you want. This example shows how you could set the `X-Frame-Options` HTTP response header to DENY.\n\n```js\n// gatsby-config.js\n\nconst { createProxyMiddleware } = require(\"http-proxy-middleware\")\n\nmodule.exports = {\n  developMiddleware: app =\u003e {\n     app.use((req, res, next) =\u003e {\n      res.set('X-Frame-Options', 'DENY');\n      next();\n    });\n  },\n}\n```\n\n## Let's break it down\n\nFirst we make sure we actually have a `gatsby-config.js` file. This file should be in the root of your Gatsby project and it can contain a bunch of different information. If you want to know more about this file, check out [Gatsby's own docs](https://www.gatsbyjs.com/docs/reference/config-files/gatsby-config/).\n\n```js\n// gatsby-config.js\n\nmodule.exports = {\n  // an empty config file!\n}\n```\n\n### Using developMiddleware\n\nTo expose Express.js we use the configuration key called `developMiddleware`. We pass it a function that takes a parameter called `app`. We can use that to [add middleware](https://expressjs.com/en/guide/using-middleware.html) to Express.js.\n\nWe use `app.use()` and pass it a function that takes `req, res, next` parameters. Inside the function we set our security header on the `res` (response) object. After this, we call the next function that we got as a parameter.\n\n```js\n// gatsby-config.js\n\nmodule.exports = {\n  developMiddleware: app =\u003e {\n     app.use((req, res, next) =\u003e {\n      res.set('X-Frame-Options', 'DENY');\n      next();\n    });\n  },\n}\n```\n\nDone! You should now be able to run `gatsby develop` and see the proper security headers on the documents that it serves you. Make sure to restart your server if you already had it running though, otherwise the changes won't come through.\n","date":["2021-09-25"],"slug":"2021-09-25-set-your-gatsby-develop-security-headers"},"__N_SSG":true},"page":"/post/[postname]","query":{"postname":"2021-09-25-set-your-gatsby-develop-security-headers"},"buildId":"4OWx1Aktir_tYSFI5ybN_","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>